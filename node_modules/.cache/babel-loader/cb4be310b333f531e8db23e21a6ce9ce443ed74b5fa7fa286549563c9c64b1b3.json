{"ast":null,"code":"var _jsxFileName = \"/Users/ksphdinhquy/Desktop/IT/checkinConUDSMP/src/Mobile.js\",\n  _s = $RefreshSig$();\nimport { collection, doc, getDocs, query, setDoc, where } from \"firebase/firestore\";\nimport moment from \"moment\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport Scanner from \"./components/scanner\";\nimport { db } from \"./firebase\";\nimport chaomung from \"./assets/checkin.png\";\nimport titlechaomung from \"./assets/titlecheckin.png\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Mobile() {\n  _s();\n  const [userCurrent, setUserCurrent] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const prev = useRef(\"\");\n  const scan = useCallback(async value => {\n    if (value === prev.current) return;\n    prev.current = value;\n    setLoading(true);\n    try {\n      const q = query(collection(db, \"users\"), where(\"qrcode\", \"==\", value));\n      const querySnapshot = await getDocs(q);\n      querySnapshot.forEach(async _doc => {\n        const date = moment().valueOf();\n        const dateString = moment(date).format(\"DD-MM-YYYY\").toString();\n        setUserCurrent({\n          ..._doc.data(),\n          checkIn: date\n        });\n        const q2 = query(collection(db, \"checkIns_test_5\"), where(\"qrcode\", \"==\", _doc.data().qrcode));\n        let checkExist = (await getDocs(q2)).docs.some(snap => dateString === moment(snap.data().checkIn).format(\"DD-MM-YYYY\").toString());\n        if (!checkExist) {\n          await setDoc(doc(db, \"checkIns_test_5\", uuidv4()), {\n            ..._doc.data(),\n            checkIn: date\n          });\n        }\n      });\n    } catch (error) {\n      console.error(\"Error during scan:\", error);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n  useEffect(() => {\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      navigator.mediaDevices.getUserMedia({\n        video: true\n      }).then(stream => {\n        console.log(stream);\n      }).catch(err => {\n        alert(\"Error accessing camera: \" + err);\n      });\n    } else {\n      alert(\"Sorry, browser does not support camera access\");\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main-wrapper position-relative\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"h-100 d-flex flex-column\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-100 d-flex justify-content-center align-items-center\",\n        style: {\n          marginBottom: \"5.5vh\",\n          marginTop: \"28vh\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex flex-column\",\n          style: {\n            width: \"40%\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Scanner, {\n            onScan: scan\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex align-items-center\",\n          style: {\n            width: \"40%\",\n            maxHeight: \"72vh\",\n            padding: \"1vh 1vw\",\n            overflow: \"auto\",\n            marginLeft: \"5.5vw\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex flex-column align-items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                maxWidth: \"100%\"\n              },\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: titlechaomung,\n                style: {\n                  width: \"100%\"\n                },\n                alt: \"Welcome Title\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 83,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"font-large text-center text-blue\",\n              style: {\n                textTransform: \"uppercase\",\n                marginBottom: \"1.15vh\",\n                fontSize: \"3.5vw\",\n                lineHeight: 1.2\n              },\n              children: (userCurrent === null || userCurrent === void 0 ? void 0 : userCurrent.nguoidaidien) || \".\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"font-large text-center text-blue\",\n              style: {\n                textTransform: \"uppercase\",\n                marginBottom: \"1.15vh\",\n                fontSize: \"2.15vw\",\n                lineHeight: 1.2\n              },\n              children: [userCurrent === null || userCurrent === void 0 ? void 0 : userCurrent.chucvu, \" \", (userCurrent === null || userCurrent === void 0 ? void 0 : userCurrent.tencongty) || \".\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                maxWidth: \"100%\",\n                marginTop: \"1vh\"\n              },\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: chaomung,\n                style: {\n                  width: \"100%\"\n                },\n                alt: \"Check-in Welcome\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 92,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-indicator\",\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 29\n      }, this), \" \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 9\n  }, this);\n}\n_s(Mobile, \"VanWYGyaKGxXisc6bMMn48/BTTc=\");\n_c = Mobile;\nexport default Mobile;\nvar _c;\n$RefreshReg$(_c, \"Mobile\");","map":{"version":3,"names":["collection","doc","getDocs","query","setDoc","where","moment","useCallback","useEffect","useRef","useState","v4","uuidv4","Scanner","db","chaomung","titlechaomung","jsxDEV","_jsxDEV","Mobile","_s","userCurrent","setUserCurrent","loading","setLoading","prev","scan","value","current","q","querySnapshot","forEach","_doc","date","valueOf","dateString","format","toString","data","checkIn","q2","qrcode","checkExist","docs","some","snap","error","console","navigator","mediaDevices","getUserMedia","video","then","stream","log","catch","err","alert","className","children","style","marginBottom","marginTop","width","onScan","fileName","_jsxFileName","lineNumber","columnNumber","maxHeight","padding","overflow","marginLeft","maxWidth","src","alt","textTransform","fontSize","lineHeight","nguoidaidien","chucvu","tencongty","_c","$RefreshReg$"],"sources":["/Users/ksphdinhquy/Desktop/IT/checkinConUDSMP/src/Mobile.js"],"sourcesContent":["import {\n    collection,\n    doc,\n    getDocs,\n    query,\n    setDoc,\n    where,\n} from \"firebase/firestore\";\nimport moment from \"moment\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport Scanner from \"./components/scanner\";\nimport { db } from \"./firebase\";\n\nimport chaomung from \"./assets/checkin.png\";\nimport titlechaomung from \"./assets/titlecheckin.png\";\n\nfunction Mobile() {\n    const [userCurrent, setUserCurrent] = useState(null);\n    const [loading, setLoading] = useState(false);\n    const prev = useRef(\"\");\n\n    const scan = useCallback(async (value) => {\n        if (value === prev.current) return;\n\n        prev.current = value;\n\n        setLoading(true);\n        try {\n            const q = query(collection(db, \"users\"), where(\"qrcode\", \"==\", value));\n            const querySnapshot = await getDocs(q);\n\n            querySnapshot.forEach(async (_doc) => {\n                const date = moment().valueOf();\n                const dateString = moment(date).format(\"DD-MM-YYYY\").toString();\n                setUserCurrent({ ..._doc.data(), checkIn: date });\n\n                const q2 = query(\n                    collection(db, \"checkIns_test_5\"),\n                    where(\"qrcode\", \"==\", _doc.data().qrcode)\n                );\n\n                let checkExist = (await getDocs(q2)).docs.some(snap =>\n                    dateString === moment(snap.data().checkIn).format(\"DD-MM-YYYY\").toString()\n                );\n\n                if (!checkExist) {\n                    await setDoc(doc(db, \"checkIns_test_5\", uuidv4()), { ..._doc.data(), checkIn: date });\n                }\n            });\n        } catch (error) {\n            console.error(\"Error during scan:\", error);\n        } finally {\n            setLoading(false);\n        }\n    }, []);\n\n    useEffect(() => {\n        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n            navigator.mediaDevices.getUserMedia({ video: true })\n                .then(stream => {\n                    console.log(stream);\n                })\n                .catch(err => {\n                    alert(\"Error accessing camera: \" + err);\n                });\n        } else {\n            alert(\"Sorry, browser does not support camera access\");\n        }\n    }, []);\n\n    return (\n        <div className=\"main-wrapper position-relative\">\n            <div className=\"h-100 d-flex flex-column\">\n                <div className=\"w-100 d-flex justify-content-center align-items-center\" style={{ marginBottom: \"5.5vh\", marginTop: \"28vh\" }}>\n                    <div className=\"d-flex flex-column\" style={{ width: \"40%\" }}>\n                        <Scanner onScan={scan} />\n                    </div>\n                    <div className=\"d-flex align-items-center\" style={{ width: \"40%\", maxHeight: \"72vh\", padding: \"1vh 1vw\", overflow: \"auto\", marginLeft: \"5.5vw\" }}>\n                        <div className=\"d-flex flex-column align-items-center\">\n                            <div style={{ maxWidth: \"100%\" }}>\n                                <img src={titlechaomung} style={{ width: \"100%\" }} alt=\"Welcome Title\" />\n                            </div>\n                            <h2 className=\"font-large text-center text-blue\" style={{ textTransform: \"uppercase\", marginBottom: \"1.15vh\", fontSize: \"3.5vw\", lineHeight: 1.2 }}>\n                                {userCurrent?.nguoidaidien || \".\"}\n                            </h2>\n                            <h2 className=\"font-large text-center text-blue\" style={{ textTransform: \"uppercase\", marginBottom: \"1.15vh\", fontSize: \"2.15vw\", lineHeight: 1.2 }}>\n                                {userCurrent?.chucvu} {userCurrent?.tencongty || \".\"}\n                            </h2>\n                            <div style={{ maxWidth: \"100%\", marginTop: \"1vh\" }}>\n                                <img src={chaomung} style={{ width: \"100%\" }} alt=\"Check-in Welcome\" />\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                {loading && <div className=\"loading-indicator\">Loading...</div>} {/* Add a loading indicator */}\n            </div>\n        </div>\n    );\n}\n\nexport default Mobile;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}