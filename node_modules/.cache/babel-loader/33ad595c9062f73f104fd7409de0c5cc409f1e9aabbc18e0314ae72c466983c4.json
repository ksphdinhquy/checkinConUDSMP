{"ast":null,"code":"var _jsxFileName = \"/Users/ksphdinhquy/Desktop/IT/checkinConUDSMP/src/components/UpdateUserModal.jsx\",\n  _s = $RefreshSig$();\nimport { Modal } from \"antd\";\nimport { doc, setDoc, collection, getDocs } from \"firebase/firestore\";\nimport React, { memo, useEffect, useState } from \"react\";\nimport { toast } from \"react-toastify\";\nimport { db } from \"../firebase\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initState = {\n  hovaten: \"\",\n  donvi: \"\",\n  sodienthoai: \"\",\n  email: \"\",\n  room: \"\" // Thêm trường room\n};\nconst UpdateUserModal = ({\n  modalIsOpen,\n  setIsOpen,\n  initForm\n}) => {\n  _s();\n  const [form, setForm] = useState(initState);\n  const [rooms, setRooms] = useState([]); // State để lưu danh sách phòng\n\n  // Hàm xử lý thay đổi input\n  const handleChange = e => {\n    setForm({\n      ...form,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  // Hàm xử lý gửi form\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const updatedForm = {\n      ...form\n    };\n    for (let [key, val] of Object.entries(updatedForm)) {\n      if (!val) {\n        delete updatedForm[key];\n      }\n    }\n    const usersRef = doc(db, \"users\", form.id);\n    try {\n      await setDoc(usersRef, updatedForm);\n      toast.success(\"Cập nhật thành công!\", {\n        position: \"top-right\",\n        autoClose: 3000,\n        hideProgressBar: false,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true\n      });\n    } catch (error) {\n      toast.error(\"Cập nhật thất bại!\", {\n        position: \"top-right\"\n      });\n    } finally {\n      setIsOpen(false);\n      setForm(initState);\n    }\n  };\n\n  // Lấy danh sách phòng từ Firestore\n  const fetchRooms = async () => {\n    const roomsCollection = collection(db, \"room\");\n    const roomSnapshot = await getDocs(roomsCollection);\n    const roomList = roomSnapshot.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n    setRooms(roomList);\n  };\n\n  // Cập nhật form khi có dữ liệu khởi tạo\n  useEffect(() => {\n    if (initForm) {\n      setForm(initForm);\n    }\n    fetchRooms(); // Gọi hàm lấy dữ liệu phòng khi modal mở\n  }, [initForm]);\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    title: \"C\\u1EADp nh\\u1EADt th\\xF4ng tin \\u0111\\u1EA1i bi\\u1EC3u\",\n    centered: true,\n    open: modalIsOpen,\n    onCancel: () => {\n      setForm(initState);\n      setIsOpen(false);\n    },\n    footer: null,\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [Object.keys(initState).map(key => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mb-0 mt-2\",\n          children: key === \"nguoidaidien\" ? \"Người đại diện\" : key\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 13\n        }, this), key === \"room\" ?\n        /*#__PURE__*/\n        // Thêm trường select cho room\n        _jsxDEV(\"select\", {\n          className: \"form-control\",\n          name: \"room\",\n          value: form.room || \"\" // Đảm bảo giá trị mặc định là string rỗng\n          ,\n          onChange: handleChange,\n          required: true,\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Ch\\u1ECDn ph\\xF2ng\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 17\n          }, this), \" \", rooms.map(room => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: room.name,\n            children: room.name\n          }, room.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 19\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"form-control\",\n          type: key === \"sokhachdikem\" ? \"number\" : \"text\",\n          placeholder: key === \"nguoidaidien\" ? \"Người đại diện\" : \"\",\n          onChange: handleChange,\n          name: key,\n          value: form[key],\n          required: key !== \"somayman\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 15\n        }, this)]\n      }, key, true, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex align-items-center\",\n        style: {\n          marginTop: \"1rem\",\n          justifyContent: \"flex-end\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"btn btn-primary text-white\",\n          children: \"L\\u01B0u\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 5\n  }, this);\n};\n_s(UpdateUserModal, \"osmLHGZCZ5f93b23KJVQZyldgeo=\");\n_c = UpdateUserModal;\nexport default _c2 = /*#__PURE__*/memo(UpdateUserModal);\nvar _c, _c2;\n$RefreshReg$(_c, \"UpdateUserModal\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"names":["Modal","doc","setDoc","collection","getDocs","React","memo","useEffect","useState","toast","db","jsxDEV","_jsxDEV","initState","hovaten","donvi","sodienthoai","email","room","UpdateUserModal","modalIsOpen","setIsOpen","initForm","_s","form","setForm","rooms","setRooms","handleChange","e","target","name","value","handleSubmit","preventDefault","updatedForm","key","val","Object","entries","usersRef","id","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","error","fetchRooms","roomsCollection","roomSnapshot","roomList","docs","map","data","title","centered","open","onCancel","footer","children","onSubmit","keys","className","fileName","_jsxFileName","lineNumber","columnNumber","onChange","required","type","placeholder","style","marginTop","justifyContent","_c","_c2","$RefreshReg$"],"sources":["/Users/ksphdinhquy/Desktop/IT/checkinConUDSMP/src/components/UpdateUserModal.jsx"],"sourcesContent":["import { Modal } from \"antd\";\nimport { doc, setDoc, collection, getDocs } from \"firebase/firestore\";\nimport React, { memo, useEffect, useState } from \"react\";\nimport { toast } from \"react-toastify\";\nimport { db } from \"../firebase\";\n\nconst initState = {\n  hovaten: \"\",\n  donvi: \"\",\n  sodienthoai: \"\",\n  email: \"\",\n  room: \"\", // Thêm trường room\n};\n\nconst UpdateUserModal = ({ modalIsOpen, setIsOpen, initForm }) => {\n  const [form, setForm] = useState(initState);\n  const [rooms, setRooms] = useState([]); // State để lưu danh sách phòng\n\n  // Hàm xử lý thay đổi input\n  const handleChange = (e) => {\n    setForm({\n      ...form,\n      [e.target.name]: e.target.value,\n    });\n  };\n\n  // Hàm xử lý gửi form\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    const updatedForm = { ...form };\n    for (let [key, val] of Object.entries(updatedForm)) {\n      if (!val) {\n        delete updatedForm[key];\n      }\n    }\n\n    const usersRef = doc(db, \"users\", form.id);\n\n    try {\n      await setDoc(usersRef, updatedForm);\n      toast.success(\"Cập nhật thành công!\", {\n        position: \"top-right\",\n        autoClose: 3000,\n        hideProgressBar: false,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true,\n      });\n    } catch (error) {\n      toast.error(\"Cập nhật thất bại!\", {\n        position: \"top-right\",\n      });\n    } finally {\n      setIsOpen(false);\n      setForm(initState);\n    }\n  };\n\n  // Lấy danh sách phòng từ Firestore\n  const fetchRooms = async () => {\n    const roomsCollection = collection(db, \"room\");\n    const roomSnapshot = await getDocs(roomsCollection);\n    const roomList = roomSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n    setRooms(roomList);\n  };\n\n  // Cập nhật form khi có dữ liệu khởi tạo\n  useEffect(() => {\n    if (initForm) {\n      setForm(initForm);\n    }\n    fetchRooms(); // Gọi hàm lấy dữ liệu phòng khi modal mở\n  }, [initForm]);\n\n  return (\n    <Modal\n      title=\"Cập nhật thông tin đại biểu\"\n      centered\n      open={modalIsOpen}\n      onCancel={() => {\n        setForm(initState);\n        setIsOpen(false);\n      }}\n      footer={null}\n    >\n      <form onSubmit={handleSubmit}>\n        {Object.keys(initState).map((key) => (\n          <div key={key}>\n            <p className=\"mb-0 mt-2\">{key === \"nguoidaidien\" ? \"Người đại diện\" : key}</p>\n            {key === \"room\" ? ( // Thêm trường select cho room\n              <select\n                className=\"form-control\"\n                name=\"room\"\n                value={form.room || \"\"} // Đảm bảo giá trị mặc định là string rỗng\n                onChange={handleChange}\n                required\n              >\n                <option value=\"\">Chọn phòng</option> {/* Hiển thị thông báo \"Chọn phòng\" */}\n                {rooms.map(room => (\n                  <option key={room.id} value={room.name}>\n                    {room.name}\n                  </option>\n                ))}\n              </select>\n            ) : (\n              <input\n                className=\"form-control\"\n                type={key === \"sokhachdikem\" ? \"number\" : \"text\"}\n                placeholder={key === \"nguoidaidien\" ? \"Người đại diện\" : \"\"}\n                onChange={handleChange}\n                name={key}\n                value={form[key]}\n                required={key !== \"somayman\"}\n              />\n            )}\n          </div>\n        ))}\n        <div\n          className=\"d-flex align-items-center\"\n          style={{\n            marginTop: \"1rem\",\n            justifyContent: \"flex-end\",\n          }}\n        >\n          <button type=\"submit\" className=\"btn btn-primary text-white\">\n            Lưu\n          </button>\n        </div>\n      </form>\n    </Modal>\n  );\n};\n\nexport default memo(UpdateUserModal);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}