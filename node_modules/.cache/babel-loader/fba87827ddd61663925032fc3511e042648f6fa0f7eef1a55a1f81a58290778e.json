{"ast":null,"code":"var _jsxFileName = \"/Users/ksphdinhquy/Desktop/IT/checkinConUDSMP/src/Mobile.js\",\n  _s = $RefreshSig$();\nimport { collection, doc, getDocs, query, setDoc, where } from \"firebase/firestore\";\nimport moment from \"moment\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport Scanner from \"./components/scanner\";\nimport { db } from \"./firebase\";\nimport nencheckinmobile from \"./assets/nencheckinmobile.png\";\nimport checkin from \"./assets/checkin.png\";\nimport titlechaomung from \"./assets/titlecheckin.png\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Mobile() {\n  _s();\n  const [userCurrent, setUserCurrent] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const prev = useRef(\"\");\n  const scan = useCallback(async value => {\n    if (value === prev.current) return;\n    prev.current = value;\n    setLoading(true);\n    try {\n      const q = query(collection(db, \"users\"), where(\"qrcode\", \"==\", value));\n      const querySnapshot = await getDocs(q);\n      querySnapshot.forEach(async _doc => {\n        const date = moment().valueOf();\n        const dateString = moment(date).format(\"DD-MM-YYYY\").toString();\n        setUserCurrent({\n          ..._doc.data(),\n          checkIn: date\n        });\n        const q2 = query(collection(db, \"checkIns_test_5\"), where(\"qrcode\", \"==\", _doc.data().qrcode));\n        let checkExist = (await getDocs(q2)).docs.some(snap => dateString === moment(snap.data().checkIn).format(\"DD-MM-YYYY\").toString());\n        if (!checkExist) {\n          await setDoc(doc(db, \"checkIns_test_5\", uuidv4()), {\n            ..._doc.data(),\n            checkIn: date\n          });\n        }\n      });\n    } catch (error) {\n      console.error(\"Error during scan:\", error);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n  useEffect(() => {\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      navigator.mediaDevices.getUserMedia({\n        video: true\n      }).then(stream => {\n        console.log(stream);\n      }).catch(err => {\n        alert(\"Error accessing camera: \" + err);\n      });\n    } else {\n      alert(\"Sorry, browser does not support camera access\");\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main-wrapper position-relative\",\n    style: {\n      backgroundImage: `url(${nencheckinmobile})`,\n      backgroundSize: 'cover',\n      backgroundPosition: 'center'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"h-100 d-flex flex-column justify-content-center align-items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"scanner-container\",\n        style: {\n          width: \"80%\",\n          maxWidth: \"400px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(Scanner, {\n          onScan: scan\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user-info text-center mt-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: titlechaomung,\n          style: {\n            width: \"80%\"\n          },\n          alt: \"Welcome Title\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"font-large text-blue\",\n          style: {\n            textTransform: \"uppercase\",\n            margin: \"1.15vh 0\",\n            fontSize: \"3.5vw\",\n            lineHeight: 1.2\n          },\n          children: (userCurrent === null || userCurrent === void 0 ? void 0 : userCurrent.nguoidaidien) || \".\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"font-large text-blue\",\n          style: {\n            textTransform: \"uppercase\",\n            margin: \"1.15vh 0\",\n            fontSize: \"2.15vw\",\n            lineHeight: 1.2\n          },\n          children: [userCurrent === null || userCurrent === void 0 ? void 0 : userCurrent.chucvu, \" \", (userCurrent === null || userCurrent === void 0 ? void 0 : userCurrent.tencongty) || \".\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          src: checkin,\n          style: {\n            width: \"80%\"\n          },\n          alt: \"checkin Title\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-indicator\",\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 29\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 9\n  }, this);\n}\n_s(Mobile, \"VanWYGyaKGxXisc6bMMn48/BTTc=\");\n_c = Mobile;\nexport default Mobile;\nvar _c;\n$RefreshReg$(_c, \"Mobile\");","map":{"version":3,"names":["collection","doc","getDocs","query","setDoc","where","moment","useCallback","useEffect","useRef","useState","v4","uuidv4","Scanner","db","nencheckinmobile","checkin","titlechaomung","jsxDEV","_jsxDEV","Mobile","_s","userCurrent","setUserCurrent","loading","setLoading","prev","scan","value","current","q","querySnapshot","forEach","_doc","date","valueOf","dateString","format","toString","data","checkIn","q2","qrcode","checkExist","docs","some","snap","error","console","navigator","mediaDevices","getUserMedia","video","then","stream","log","catch","err","alert","className","style","backgroundImage","backgroundSize","backgroundPosition","children","width","maxWidth","onScan","fileName","_jsxFileName","lineNumber","columnNumber","src","alt","textTransform","margin","fontSize","lineHeight","nguoidaidien","chucvu","tencongty","_c","$RefreshReg$"],"sources":["/Users/ksphdinhquy/Desktop/IT/checkinConUDSMP/src/Mobile.js"],"sourcesContent":["import {\n    collection,\n    doc,\n    getDocs,\n    query,\n    setDoc,\n    where,\n} from \"firebase/firestore\";\nimport moment from \"moment\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport Scanner from \"./components/scanner\";\nimport { db } from \"./firebase\";\nimport nencheckinmobile from \"./assets/nencheckinmobile.png\";\nimport checkin from \"./assets/checkin.png\";\nimport titlechaomung from \"./assets/titlecheckin.png\";\n\nfunction Mobile() {\n    const [userCurrent, setUserCurrent] = useState(null);\n    const [loading, setLoading] = useState(false);\n    const prev = useRef(\"\");\n\n    const scan = useCallback(async (value) => {\n        if (value === prev.current) return;\n\n        prev.current = value;\n\n        setLoading(true);\n        try {\n            const q = query(collection(db, \"users\"), where(\"qrcode\", \"==\", value));\n            const querySnapshot = await getDocs(q);\n\n            querySnapshot.forEach(async (_doc) => {\n                const date = moment().valueOf();\n                const dateString = moment(date).format(\"DD-MM-YYYY\").toString();\n                setUserCurrent({ ..._doc.data(), checkIn: date });\n\n                const q2 = query(\n                    collection(db, \"checkIns_test_5\"),\n                    where(\"qrcode\", \"==\", _doc.data().qrcode)\n                );\n\n                let checkExist = (await getDocs(q2)).docs.some(snap =>\n                    dateString === moment(snap.data().checkIn).format(\"DD-MM-YYYY\").toString()\n                );\n\n                if (!checkExist) {\n                    await setDoc(doc(db, \"checkIns_test_5\", uuidv4()), { ..._doc.data(), checkIn: date });\n                }\n            });\n        } catch (error) {\n            console.error(\"Error during scan:\", error);\n        } finally {\n            setLoading(false);\n        }\n    }, []);\n\n    useEffect(() => {\n        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n            navigator.mediaDevices.getUserMedia({ video: true })\n                .then(stream => {\n                    console.log(stream);\n                })\n                .catch(err => {\n                    alert(\"Error accessing camera: \" + err);\n                });\n        } else {\n            alert(\"Sorry, browser does not support camera access\");\n        }\n    }, []);\n\n    return (\n        <div className=\"main-wrapper position-relative\" style={{ backgroundImage: `url(${nencheckinmobile})`, backgroundSize: 'cover', backgroundPosition: 'center' }}>\n            <div className=\"h-100 d-flex flex-column justify-content-center align-items-center\">\n                <div className=\"scanner-container\" style={{ width: \"80%\", maxWidth: \"400px\" }}>\n                    <Scanner onScan={scan} />\n                </div>\n                <div className=\"user-info text-center mt-4\">\n                    <img src={titlechaomung} style={{ width: \"80%\" }} alt=\"Welcome Title\" />\n                    <h2 className=\"font-large text-blue\" style={{ textTransform: \"uppercase\", margin: \"1.15vh 0\", fontSize: \"3.5vw\", lineHeight: 1.2 }}>\n                        {userCurrent?.nguoidaidien || \".\"}\n                    </h2>\n                    <h2 className=\"font-large text-blue\" style={{ textTransform: \"uppercase\", margin: \"1.15vh 0\", fontSize: \"2.15vw\", lineHeight: 1.2 }}>\n                        {userCurrent?.chucvu} {userCurrent?.tencongty || \".\"}\n                    </h2>\n                    <img src={checkin} style={{ width: \"80%\" }} alt=\"checkin Title\" />\n                </div>\n                {loading && <div className=\"loading-indicator\">Loading...</div>}\n            </div>\n        </div>\n    );\n}\n\nexport default Mobile;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}